import requests
from requests.auth import HTTPBasicAuth

# Replace with your GitHub username and personal access token
GITHUB_USERNAME = 'your_github_username'
GITHUB_TOKEN = 'your_personal_access_token'

# GitHub API URL to get user repositories
REPOS_URL = f'https://api.github.com/users/{GITHUB_USERNAME}/repos'

def get_repos(url, username, token):
    repos = []
    while url:
        response = requests.get(url, auth=HTTPBasicAuth(username, token))
        response.raise_for_status()
        repos.extend(response.json())
        url = response.links.get('next', {}).get('url')
    return repos

def get_commit_count(repo_full_name, username, token):
    commits_url = f'https://api.github.com/repos/{repo_full_name}/commits'
    params = {'author': username}
    total_commits = 0
    while commits_url:
        response = requests.get(commits_url, auth=HTTPBasicAuth(username, token), params=params)
        response.raise_for_status()
        commits = response.json()
        total_commits += len(commits)
        commits_url = response.links.get('next', {}).get('url')
    return total_commits

def main():
    repos = get_repos(REPOS_URL, GITHUB_USERNAME, GITHUB_TOKEN)
    total_commits = 0
    for repo in repos:
        repo_full_name = repo['full_name']
        print(f'Fetching commits for repository: {repo_full_name}')
        repo_commit_count = get_commit_count(repo_full_name, GITHUB_USERNAME, GITHUB_TOKEN)
        total_commits += repo_commit_count
        print(f'{repo_full_name}: {repo_commit_count} commits')
    print(f'Total commits across all repositories: {total_commits}')

if __name__ == '__main__':
    main()
