import pandas as pd

# Load data from Excel files
dev_df = pd.read_excel('.\DataCompare\Info_dev.xlsx')  # Replace with actual DEV excel file path
prod_df = pd.read_excel('.\DataCompare\Info_prod.xlsx')  # Replace with actual PROD excel file path

# Merge DEV and PROD tables on 'id' column (outer join)
merged_df = pd.merge(dev_df, prod_df, on='Id', how='outer', suffixes=('_dev', '_prod'))

# Create a comparison DataFrame starting with the 'id' column
comparison_df = pd.DataFrame()
comparison_df['Id'] = merged_df['Id']  # Keep the 'id' column

# Iterate over columns to compare values
for col in dev_df.columns:
    if col != 'Id':  # Skip the 'id' column for comparison
        comparison_df[col] = merged_df.apply(
            lambda row: True if row[f'{col}_dev'] == row[f'{col}_prod'] else False, axis=1)

# Handle cases where rows are missing in DEV or PROD
comparison_df['row_status'] = merged_df.apply(
    lambda row: 'Missing in DEV' if pd.isnull(row[f'{col}_dev'])
    else ('Missing in PROD' if pd.isnull(row[f'{col}_prod']) else 'Present'), axis=1)

# Save comparison result to a new Excel file, including the 'id' field
comparison_df.to_excel('comparison_result.xlsx', index=False)
