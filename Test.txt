import cx_Oracle
import pandas as pd

# Database connection details
db1_config = {
    'user': 'user1',
    'password': 'password1',
    'dsn': 'dsn1'
}

db2_config = {
    'user': 'user2',
    'password': 'password2',
    'dsn': 'dsn2'
}

def fetch_table_data(config, table_name):
    try:
        # Establish the database connection
        conn = cx_Oracle.connect(
            user=config['user'],
            password=config['password'],
            dsn=config['dsn']
        )
        # SQL query to fetch all data from the table
        query = f"SELECT * FROM {table_name}"
        # Use pandas to read SQL query into a DataFrame
        df = pd.read_sql(query, conn)
        # Close the connection
        conn.close()
        return df
    except cx_Oracle.DatabaseError as e:
        print(f"Database error: {e}")
        return None

def compare_tables(table1, table2):
    # Compare DataFrames
    comparison = table1.compare(table2, align_axis=1, keep_shape=True, keep_equal=True)
    return comparison

def main():
    table_name = 'YOUR_TABLE_NAME'  # Replace with your table name
    
    # Fetch data from both databases
    table1_data = fetch_table_data(db1_config, table_name)
    table2_data = fetch_table_data(db2_config, table_name)

    if table1_data is None or table2_data is None:
        print("Failed to fetch data from one or both databases.")
        return

    # Compare the tables
    comparison_result = compare_tables(table1_data, table2_data)
    
    if comparison_result.empty:
        print("The tables are identical.")
    else:
        print("Differences found:")
        print(comparison_result)

if __name__ == "__main__":
    main()
