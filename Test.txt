using System;
using System.Text.RegularExpressions;

public class DataMasking
{
    public static string PartialMasking(string input)
    {
        if (string.IsNullOrEmpty(input))
        {
            // Handle invalid input
            return input;
        }

        // Define regular expression patterns for credit card numbers, SSN, and DOB
        string creditCardPattern = @"\b(\d{4}-\d{4}-\d{4}-\d{4})\b";
        string ssnPattern = @"\b(\d{3}-\d{2}-\d{4})\b";
        string dobPattern = @"\b(\d{2}/\d{2}/\d{4})\b";

        // Perform partial masking on credit card numbers
        input = ApplyPartialMasking(input, creditCardPattern, 4);

        // Perform partial masking on SSN
        input = ApplyPartialMasking(input, ssnPattern, 3);

        // Perform partial masking on DOB
        input = ApplyPartialMasking(input, dobPattern, 2);

        return input;
    }

    private static string ApplyPartialMasking(string input, string pattern, int visibleLength)
    {
        // Use regular expression to find matches
        MatchCollection matches = Regex.Matches(input, pattern);

        // Iterate through matches and apply partial masking
        foreach (Match match in matches)
        {
            if (match.Groups.Count > 1)
            {
                // Keep only a portion of the sensitive information visible
                string visiblePart = match.Groups[1].Value.Substring(Math.Max(0, match.Groups[1].Value.Length - visibleLength));
                string maskedValue = new string('*', match.Groups[1].Value.Length - visiblePart.Length) + visiblePart;

                // Replace the sensitive information with the masked value
                input = input.Replace(match.Groups[1].Value, maskedValue);
            }
        }

        return input;
    }

    public static void Main()
    {
        // Example usage
        string inputText = "Credit Card: 1234-5678-9012-3456, SSN: 123-45-6789, DOB: 01/15/1980.";

        // Perform partial masking on various sensitive information
        string maskedText = PartialMasking(inputText);

        Console.WriteLine("Original Text: " + inputText);
        Console.WriteLine("Masked Text: " + maskedText);
    }
}
